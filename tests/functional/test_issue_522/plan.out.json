{"format_version":"0.1","terraform_version":"1.0.0","variables":{"app_instance_name":{"value":"primary"},"app_name":{"value":"metrics-lambda"},"aws_region":{"value":""},"enable_alert":{"value":"false"},"log_level":{"value":"WARNING"},"slack_channel":{"value":"metricos_alerts_dev"},"zipfile":{"value":"/workspace/output/lambda.zip"}},"planned_values":{"outputs":{"lambda_function_arn":{"sensitive":false},"lambda_function_name":{"sensitive":false,"value":"metrics-lambda-primary-lambda"}},"root_module":{"resources":[{"address":"aws_cloudwatch_event_rule.metrics_schedule","mode":"managed","type":"aws_cloudwatch_event_rule","name":"metrics_schedule","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"","description":"","event_bus_name":"default","event_pattern":null,"id":"metrics-lambda-pri20210708075056362700000001","is_enabled":true,"name":"metrics-lambda-pri20210708075056362700000001","name_prefix":"metrics-lambda-pri","role_arn":"","schedule_expression":"rate(2 minutes)","tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-metric-schedule","Owner":"Metrics","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-metric-schedule","Owner":"Metrics","Product":"Metricos","Team":"Metricos"}}},{"address":"aws_cloudwatch_event_target.metric_event_target","mode":"managed","type":"aws_cloudwatch_event_target","name":"metric_event_target","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"batch_target":[],"dead_letter_config":[],"ecs_target":[],"event_bus_name":"default","http_target":[],"id":"metrics-lambda-pri20210708075056362700000001-terraform-20210708075329318900000003","input":"{\"actions\":[\"publish_alb_max_rules\",\"publish_rds_max_connections\"]}","input_path":"","input_transformer":[],"kinesis_target":[],"retry_policy":[],"role_arn":"","rule":"metrics-lambda-pri20210708075056362700000001","run_command_targets":[],"sqs_target":[],"target_id":"terraform-20210708075329318900000003"}},{"address":"aws_cloudwatch_log_group.log_group","mode":"managed","type":"aws_cloudwatch_log_group","name":"log_group","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"","id":"/aws/lambda/metrics-lambda-primary-lambda","kms_key_id":"","name":"/aws/lambda/metrics-lambda-primary-lambda","name_prefix":null,"retention_in_days":14,"tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"primary-example_lambda_log_group","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"primary-example_lambda_log_group","Owner":"Metricos","Product":"Metricos","Team":"Metricos"}}},{"address":"aws_iam_role.lambda_execution_role","mode":"managed","type":"aws_iam_role","name":"lambda_execution_role","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"","assume_role_policy":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Sid\":\"\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}","create_date":"2021-06-20T04:15:15Z","description":"","force_detach_policies":false,"id":"terraform-20210620041514555500000001","inline_policy":[{"name":"terraform-20210620041517969300000003","policy":""}],"managed_policy_arns":[],"max_session_duration":3600,"name":"terraform-20210620041514555500000001","name_prefix":null,"path":"/","permissions_boundary":null,"tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"primary-execution_role","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"primary-execution_role","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"unique_id":"AROAYBXPULJKAPCCFKJ5K"}},{"address":"aws_iam_role_policy.lambda_execution_policy","mode":"managed","type":"aws_iam_role_policy","name":"lambda_execution_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"id":"terraform-20210620041514555500000001:terraform-20210620041517969300000003","name":"terraform-20210620041517969300000003","name_prefix":null,"policy":"","role":"terraform-20210620041514555500000001"}},{"address":"aws_iam_role_policy_attachment.lambda_execution_policy_attachment_vpc_access","mode":"managed","type":"aws_iam_role_policy_attachment","name":"lambda_execution_policy_attachment_vpc_access","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"id":"terraform-20210620041514555500000001-20210620041518840600000004","policy_arn":"","role":"terraform-20210620041514555500000001"}},{"address":"aws_iam_role_policy_attachment.lambda_logging_policy_attachment","mode":"managed","type":"aws_iam_role_policy_attachment","name":"lambda_logging_policy_attachment","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"id":"terraform-20210620041514555500000001-20210620041518845600000005","policy_arn":"","role":"terraform-20210620041514555500000001"}},{"address":"aws_lambda_function.lambda","mode":"managed","type":"aws_lambda_function","name":"lambda","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"code_signing_config_arn":null,"dead_letter_config":[],"description":null,"environment":[{"variables":{"AWS_MAX_ATTEMPTS":"11","AWS_RETRY_MODE":"adaptive","EVENT_BUS_ARN":"","FUNCTION_NAME":"metrics-lambda-primary-lambda","LOG_LEVEL":"WARNING","RDS_INFO_SSM_PATH":"/rds/metricos/info","SLACK_CHANNEL":"metricos_alerts_dev"}}],"file_system_config":[],"filename":"/workspace/output/lambda.zip","function_name":"metrics-lambda-primary-lambda","handler":"main.lambda_handler","image_config":[],"image_uri":null,"kms_key_arn":null,"layers":null,"memory_size":128,"package_type":"Zip","publish":false,"reserved_concurrent_executions":-1,"role":"","runtime":"python3.8","s3_bucket":null,"s3_key":null,"s3_object_version":null,"source_code_hash":"W5+gUPgM78w789Fevf8xDUe/sfi26j3YmdGYVsbWfrU=","tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-lambda","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-lambda","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"timeout":60,"timeouts":null,"vpc_config":[{"subnet_ids":["subnet-081c9cbe188e2e3c5","subnet-08a678ede68202ff3","subnet-0bd9b444e36f39c73"]}]}},{"address":"aws_lambda_permission.allow_alert_event_bridge_to_call_monitor_metric_lambdas_frequent[0]","mode":"managed","type":"aws_lambda_permission","name":"allow_alert_event_bridge_to_call_monitor_metric_lambdas_frequent","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0},{"address":"aws_lambda_permission.allow_metric_event_bridge_to_call_monitor_metric_lambda","mode":"managed","type":"aws_lambda_permission","name":"allow_metric_event_bridge_to_call_monitor_metric_lambda","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"action":"lambda:InvokeFunction","event_source_token":null,"function_name":"metrics-lambda-primary-lambda","principal":"events.amazonaws.com","qualifier":null,"source_account":null,"source_arn":"","statement_id_prefix":null}},{"address":"aws_security_group.lambda_sg","mode":"managed","type":"aws_security_group","name":"lambda_sg","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"description":"","name_prefix":"metrics-lambda-primary-lambda-sg","revoke_rules_on_delete":false,"tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-lambda-sg","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-lambda-sg","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"timeouts":null,"vpc_id":"vpc-003e06e33a87c22f5"}},{"address":"aws_security_group_rule.task_sg_egress_rule","mode":"managed","type":"aws_security_group_rule","name":"task_sg_egress_rule","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"cidr_blocks":[],"description":null,"from_port":0,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"-1","self":false,"to_port":0,"type":"egress"}},{"address":"aws_ssm_parameter.lambda_sg_id","mode":"managed","type":"aws_ssm_parameter","name":"lambda_sg_id","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"allowed_pattern":null,"description":"","name":"/metrics-lambda/lambda/sg_id/primary","overwrite":null,"tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-lambda_sg_id","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-lambda_sg_id","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tier":"Standard","type":"String"}}]}},"resource_drift":[{"mode":"managed","type":"aws_cloudwatch_event_rule","name":"metrics_schedule","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["update"],"before":{"arn":"","description":"","event_bus_name":"default","event_pattern":null,"id":"metrics-lambda-pri20210708075056362700000001","is_enabled":true,"name":"metrics-lambda-pri20210708075056362700000001","name_prefix":"metrics-lambda-pri","role_arn":"","schedule_expression":"rate(2 minutes)","tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-metric-schedule","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-metric-schedule","Owner":"Metricos","Product":"Metricos","Team":"Metricos"}},"after":{"arn":"","description":"","event_bus_name":"default","event_pattern":null,"id":"metrics-lambda-pri20210708075056362700000001","is_enabled":true,"name":"metrics-lambda-pri20210708075056362700000001","name_prefix":"metrics-lambda-pri","role_arn":"","schedule_expression":"rate(2 minutes)","tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-metric-schedule","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-metric-schedule","Owner":"Metricos","Product":"Metricos","Team":"Metricos"}},"before_sensitive":{"tags":{},"tags_all":{}},"after_sensitive":{"tags":{},"tags_all":{}}}},{"mode":"managed","type":"aws_cloudwatch_event_target","name":"Metricos_custom_alert_event_target_frequent","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["update"],"before":{"arn":"","batch_target":[],"dead_letter_config":[],"ecs_target":[],"event_bus_name":"default","http_target":[],"id":"metrics-lambda-pri20210709064633847000000001-terraform-20210709064657895500000003","input":"{\"actions\":[\"rds_connectivity_alert\"]}","input_path":"","input_transformer":[],"kinesis_target":[],"retry_policy":[],"role_arn":"","rule":"metrics-lambda-pri20210709064633847000000001","run_command_targets":[],"sqs_target":[],"target_id":"terraform-20210709064657895500000003"},"after":{"arn":"","batch_target":[],"dead_letter_config":[],"ecs_target":[],"event_bus_name":"default","http_target":[],"id":"metrics-lambda-pri20210709064633847000000001-terraform-20210709064657895500000003","input":"{\"actions\":[\"rds_connectivity_alert\"]}","input_path":"","input_transformer":[],"kinesis_target":[],"retry_policy":[],"role_arn":"","rule":"metrics-lambda-pri20210709064633847000000001","run_command_targets":[],"sqs_target":[],"target_id":"terraform-20210709064657895500000003"},"before_sensitive":{"batch_target":[],"dead_letter_config":[],"ecs_target":[],"http_target":[],"input_transformer":[],"kinesis_target":[],"retry_policy":[],"run_command_targets":[],"sqs_target":[]},"after_sensitive":{"batch_target":[],"dead_letter_config":[],"ecs_target":[],"http_target":[],"input_transformer":[],"kinesis_target":[],"retry_policy":[],"run_command_targets":[],"sqs_target":[]}}},{"mode":"managed","type":"aws_iam_role_policy","name":"lambda_execution_policy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["update"],"before":{"id":"terraform-20210620041514555500000001:terraform-20210620041517969300000003","name":"terraform-20210620041517969300000003","name_prefix":null,"policy":"","role":"terraform-20210620041514555500000001"},"after":{"id":"terraform-20210620041514555500000001:terraform-20210620041517969300000003","name":"terraform-20210620041517969300000003","name_prefix":null,"policy":"","role":"terraform-20210620041514555500000001"},"before_sensitive":{},"after_sensitive":{}}},{"mode":"managed","type":"aws_cloudwatch_event_rule","name":"Metricos_custom_alert_schedule_frequent","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["update"],"before":{"arn":"","description":"","event_bus_name":"default","event_pattern":null,"id":"metrics-lambda-pri20210709064633847000000001","is_enabled":true,"name":"metrics-lambda-pri20210709064633847000000001","name_prefix":"metrics-lambda-pri","role_arn":"","schedule_expression":"rate(2 minutes)","tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-alert-schedule","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-alert-schedule","Owner":"Metricos","Product":"Metricos","Team":"Metricos"}},"after":{"arn":"","description":"","event_bus_name":"default","event_pattern":null,"id":"metrics-lambda-pri20210709064633847000000001","is_enabled":true,"name":"metrics-lambda-pri20210709064633847000000001","name_prefix":"metrics-lambda-pri","role_arn":"","schedule_expression":"rate(2 minutes)","tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-alert-schedule","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-alert-schedule","Owner":"Metricos","Product":"Metricos","Team":"Metricos"}},"before_sensitive":{"tags":{},"tags_all":{}},"after_sensitive":{"tags":{},"tags_all":{}}}},{"mode":"managed","type":"aws_iam_role_policy_attachment","name":"lambda_logging_policy_attachment","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["update"],"before":{"id":"terraform-20210620041514555500000001-20210620041518845600000005","policy_arn":"","role":"terraform-20210620041514555500000001"},"after":{"id":"terraform-20210620041514555500000001-20210620041518845600000005","policy_arn":"","role":"terraform-20210620041514555500000001"},"before_sensitive":{},"after_sensitive":{}}},{"mode":"managed","type":"aws_lambda_permission","name":"allow_alert_event_bridge_to_call_monitor_metric_lambdas_frequent","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["delete"],"before":{"action":"lambda:InvokeFunction","event_source_token":null,"function_name":"metrics-lambda-primary-lambda","id":"terraform-20210709064657889900000002","principal":"events.amazonaws.com","qualifier":"","source_account":null,"source_arn":"","statement_id":"terraform-20210709064657889900000002","statement_id_prefix":null},"after":null,"before_sensitive":{},"after_sensitive":false}},{"mode":"managed","type":"aws_iam_role_policy_attachment","name":"lambda_execution_policy_attachment_vpc_access","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["update"],"before":{"id":"terraform-20210620041514555500000001-20210620041518840600000004","policy_arn":"","role":"terraform-20210620041514555500000001"},"after":{"id":"terraform-20210620041514555500000001-20210620041518840600000004","policy_arn":"","role":"terraform-20210620041514555500000001"},"before_sensitive":{},"after_sensitive":{}}},{"mode":"managed","type":"aws_lambda_permission","name":"allow_metric_event_bridge_to_call_monitor_metric_lambda","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["delete"],"before":{"action":"lambda:InvokeFunction","event_source_token":null,"function_name":"metrics-lambda-primary-lambda","id":"terraform-20210708075329318500000002","principal":"events.amazonaws.com","qualifier":"","source_account":null,"source_arn":"","statement_id":"terraform-20210708075329318500000002","statement_id_prefix":null},"after":null,"before_sensitive":{},"after_sensitive":false}},{"mode":"managed","type":"aws_cloudwatch_log_group","name":"log_group","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["update"],"before":{"arn":"","id":"/aws/lambda/metrics-lambda-primary-lambda","kms_key_id":"","name":"/aws/lambda/metrics-lambda-primary-lambda","name_prefix":null,"retention_in_days":14,"tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"primary-example_lambda_log_group","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"primary-example_lambda_log_group","Owner":"Metricos","Product":"Metricos","Team":"Metricos"}},"after":{"arn":"","id":"/aws/lambda/metrics-lambda-primary-lambda","kms_key_id":"","name":"/aws/lambda/metrics-lambda-primary-lambda","name_prefix":null,"retention_in_days":14,"tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"primary-example_lambda_log_group","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"primary-example_lambda_log_group","Owner":"Metricos","Product":"Metricos","Team":"Metricos"}},"before_sensitive":{"tags":{},"tags_all":{}},"after_sensitive":{"tags":{},"tags_all":{}}}},{"mode":"managed","type":"aws_security_group","name":"lambda_sg","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["delete"],"before":{"arn":"","description":"","egress":[{"cidr_blocks":[],"description":"","from_port":0,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"-1","security_groups":[],"self":false,"to_port":0}],"id":"sg-08b22863dae13a7c6","ingress":[],"name":"metrics-lambda-primary-lambda-sg20210704013444222800000001","name_prefix":"metrics-lambda-primary-lambda-sg","owner_id":"553479592532","revoke_rules_on_delete":false,"tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-lambda-sg","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-lambda-sg","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"timeouts":null,"vpc_id":"vpc-003e06e33a87c22f5"},"after":null,"before_sensitive":{"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"ingress":[],"tags":{},"tags_all":{}},"after_sensitive":false}},{"mode":"managed","type":"aws_ssm_parameter","name":"lambda_sg_id","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["delete"],"before":{"allowed_pattern":"","arn":"","data_type":"text","description":"","id":"/metrics-lambda/lambda/sg_id/primary","key_id":"","name":"/metrics-lambda/lambda/sg_id/primary","overwrite":null,"tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-lambda_sg_id","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-lambda_sg_id","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tier":"Standard","type":"String","value":"","version":1},"after":null,"before_sensitive":{"tags":{},"tags_all":{}},"after_sensitive":false}},{"mode":"managed","type":"aws_cloudwatch_event_target","name":"metric_event_target","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["update"],"before":{"arn":"","batch_target":[],"dead_letter_config":[],"ecs_target":[],"event_bus_name":"default","http_target":[],"id":"metrics-lambda-pri20210708075056362700000001-terraform-20210708075329318900000003","input":"{\"actions\":[\"publish_alb_max_rules\",\"publish_rds_max_connections\"]}","input_path":"","input_transformer":[],"kinesis_target":[],"retry_policy":[],"role_arn":"","rule":"metrics-lambda-pri20210708075056362700000001","run_command_targets":[],"sqs_target":[],"target_id":"terraform-20210708075329318900000003"},"after":{"arn":"","batch_target":[],"dead_letter_config":[],"ecs_target":[],"event_bus_name":"default","http_target":[],"id":"metrics-lambda-pri20210708075056362700000001-terraform-20210708075329318900000003","input":"{\"actions\":[\"publish_alb_max_rules\",\"publish_rds_max_connections\"]}","input_path":"","input_transformer":[],"kinesis_target":[],"retry_policy":[],"role_arn":"","rule":"metrics-lambda-pri20210708075056362700000001","run_command_targets":[],"sqs_target":[],"target_id":"terraform-20210708075329318900000003"},"before_sensitive":{"batch_target":[],"dead_letter_config":[],"ecs_target":[],"http_target":[],"input_transformer":[],"kinesis_target":[],"retry_policy":[],"run_command_targets":[],"sqs_target":[]},"after_sensitive":{"batch_target":[],"dead_letter_config":[],"ecs_target":[],"http_target":[],"input_transformer":[],"kinesis_target":[],"retry_policy":[],"run_command_targets":[],"sqs_target":[]}}},{"mode":"managed","type":"aws_iam_role","name":"lambda_execution_role","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["update"],"before":{"arn":"","assume_role_policy":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Sid\":\"\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}","create_date":"2021-06-20T04:15:15Z","description":"","force_detach_policies":false,"id":"terraform-20210620041514555500000001","inline_policy":[{"name":"terraform-20210620041517969300000003","policy":""}],"managed_policy_arns":[],"max_session_duration":3600,"name":"terraform-20210620041514555500000001","name_prefix":null,"path":"/","permissions_boundary":null,"tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"primary-execution_role","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"primary-execution_role","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"unique_id":"AROAYBXPULJKAPCCFKJ5K"},"after":{"arn":"","assume_role_policy":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Sid\":\"\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}","create_date":"2021-06-20T04:15:15Z","description":"","force_detach_policies":false,"id":"terraform-20210620041514555500000001","inline_policy":[{"name":"terraform-20210620041517969300000003","policy":""}],"managed_policy_arns":[],"max_session_duration":3600,"name":"terraform-20210620041514555500000001","name_prefix":null,"path":"/","permissions_boundary":null,"tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"primary-execution_role","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"primary-execution_role","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"unique_id":"AROAYBXPULJKAPCCFKJ5K"},"before_sensitive":{"inline_policy":[{}],"managed_policy_arns":[false,false],"tags":{},"tags_all":{}},"after_sensitive":{"inline_policy":[{}],"managed_policy_arns":[false,false],"tags":{},"tags_all":{}}}},{"mode":"managed","type":"aws_lambda_function","name":"lambda","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["delete"],"before":{"arn":"","code_signing_config_arn":"","dead_letter_config":[],"description":"","environment":[{"variables":{"AWS_MAX_ATTEMPTS":"11","AWS_RETRY_MODE":"adaptive","FUNCTION_NAME":"metrics-lambda-primary-lambda","LOG_LEVEL":"INFO","RDS_INFO_SSM_PATH":"/rds/metricos/info","SLACK_CHANNEL":"metricos_alerts_dev"}}],"file_system_config":[],"filename":"/workspace/output/lambda.zip","function_name":"metrics-lambda-primary-lambda","handler":"main.lambda_handler","id":"metrics-lambda-primary-lambda","image_config":[],"image_uri":"","invoke_arn":"","kms_key_arn":"","last_modified":"2021-07-09T07:14:00.659+0000","layers":[],"memory_size":128,"package_type":"Zip","publish":false,"qualified_arn":"","reserved_concurrent_executions":-1,"role":"","runtime":"python3.8","s3_bucket":null,"s3_key":null,"s3_object_version":null,"signing_job_arn":"","signing_profile_version_arn":"","source_code_hash":"7SKHJH2/IQigSGGjOXmMUbEqlGHb8VirvU6EZ8DFw/4=","source_code_size":20302636,"tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-lambda","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-lambda","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"timeout":60,"timeouts":null,"tracing_config":[{"mode":"PassThrough"}],"version":"$LATEST","vpc_config":[{"security_group_ids":["sg-08b22863dae13a7c6"],"subnet_ids":["subnet-081c9cbe188e2e3c5","subnet-08a678ede68202ff3","subnet-0bd9b444e36f39c73"],"vpc_id":"vpc-003e06e33a87c22f5"}]},"after":null,"before_sensitive":{"dead_letter_config":[],"environment":[{"variables":{"EVENT_BUS_ARN":true}}],"file_system_config":[],"image_config":[],"layers":[],"tags":{},"tags_all":{},"tracing_config":[{}],"vpc_config":[{"security_group_ids":[false],"subnet_ids":[false,false,false]}]},"after_sensitive":false}},{"mode":"managed","type":"aws_security_group_rule","name":"task_sg_egress_rule","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["delete"],"before":{"cidr_blocks":[],"description":"","from_port":0,"id":"sgrule-950073191","ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"-1","security_group_id":"sg-08b22863dae13a7c6","self":false,"source_security_group_id":null,"to_port":0,"type":"egress"},"after":null,"before_sensitive":{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[]},"after_sensitive":false}}],"resource_changes":[{"address":"aws_cloudwatch_event_rule.Metricos_custom_alert_schedule_frequent[0]","mode":"managed","type":"aws_cloudwatch_event_rule","name":"Metricos_custom_alert_schedule_frequent","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["delete"],"before":{"arn":"","description":"Scheduled alert which needs a higher check frequency","event_bus_name":"default","event_pattern":null,"id":"metrics-lambda-pri20210709064633847000000001","is_enabled":true,"name":"metrics-lambda-pri20210709064633847000000001","name_prefix":"metrics-lambda-pri","role_arn":"","schedule_expression":"rate(2 minutes)","tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-alert-schedule","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-alert-schedule","Owner":"Metricos","Product":"Metricos","Team":"Metricos"}},"after":null,"after_unknown":{},"before_sensitive":{"tags":{},"tags_all":{}},"after_sensitive":false}},{"address":"aws_cloudwatch_event_rule.metrics_schedule","mode":"managed","type":"aws_cloudwatch_event_rule","name":"metrics_schedule","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["no-op"],"before":{"arn":"","description":"","event_bus_name":"default","event_pattern":null,"id":"metrics-lambda-pri20210708075056362700000001","is_enabled":true,"name":"metrics-lambda-pri20210708075056362700000001","name_prefix":"metrics-lambda-pri","role_arn":"","schedule_expression":"rate(2 minutes)","tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-metric-schedule","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-metric-schedule","Owner":"Metricos","Product":"Metricos","Team":"Metricos"}},"after":{"arn":"","description":"","event_bus_name":"default","event_pattern":null,"id":"metrics-lambda-pri20210708075056362700000001","is_enabled":true,"name":"metrics-lambda-pri20210708075056362700000001","name_prefix":"metrics-lambda-pri","role_arn":"","schedule_expression":"rate(2 minutes)","tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-metric-schedule","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-metric-schedule","Owner":"Metricos","Product":"Metricos","Team":"Metricos"}},"after_unknown":{},"before_sensitive":{"tags":{},"tags_all":{}},"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"aws_cloudwatch_event_target.Metricos_custom_alert_event_target_frequent[0]","mode":"managed","type":"aws_cloudwatch_event_target","name":"Metricos_custom_alert_event_target_frequent","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["delete"],"before":{"arn":"","batch_target":[],"dead_letter_config":[],"ecs_target":[],"event_bus_name":"default","http_target":[],"id":"metrics-lambda-pri20210709064633847000000001-terraform-20210709064657895500000003","input":"{\"actions\":[\"rds_connectivity_alert\"]}","input_path":"","input_transformer":[],"kinesis_target":[],"retry_policy":[],"role_arn":"","rule":"metrics-lambda-pri20210709064633847000000001","run_command_targets":[],"sqs_target":[],"target_id":"terraform-20210709064657895500000003"},"after":null,"after_unknown":{},"before_sensitive":{"batch_target":[],"dead_letter_config":[],"ecs_target":[],"http_target":[],"input_transformer":[],"kinesis_target":[],"retry_policy":[],"run_command_targets":[],"sqs_target":[]},"after_sensitive":false}},{"address":"aws_cloudwatch_event_target.metric_event_target","mode":"managed","type":"aws_cloudwatch_event_target","name":"metric_event_target","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["update"],"before":{"arn":"","batch_target":[],"dead_letter_config":[],"ecs_target":[],"event_bus_name":"default","http_target":[],"id":"metrics-lambda-pri20210708075056362700000001-terraform-20210708075329318900000003","input":"{\"actions\":[\"publish_alb_max_rules\",\"publish_rds_max_connections\"]}","input_path":"","input_transformer":[],"kinesis_target":[],"retry_policy":[],"role_arn":"","rule":"metrics-lambda-pri20210708075056362700000001","run_command_targets":[],"sqs_target":[],"target_id":"terraform-20210708075329318900000003"},"after":{"batch_target":[],"dead_letter_config":[],"ecs_target":[],"event_bus_name":"default","http_target":[],"id":"metrics-lambda-pri20210708075056362700000001-terraform-20210708075329318900000003","input":"{\"actions\":[\"publish_alb_max_rules\",\"publish_rds_max_connections\"]}","input_path":"","input_transformer":[],"kinesis_target":[],"retry_policy":[],"role_arn":"","rule":"metrics-lambda-pri20210708075056362700000001","run_command_targets":[],"sqs_target":[],"target_id":"terraform-20210708075329318900000003"},"after_unknown":{"arn":true,"batch_target":[],"dead_letter_config":[],"ecs_target":[],"http_target":[],"input_transformer":[],"kinesis_target":[],"retry_policy":[],"run_command_targets":[],"sqs_target":[]},"before_sensitive":{"batch_target":[],"dead_letter_config":[],"ecs_target":[],"http_target":[],"input_transformer":[],"kinesis_target":[],"retry_policy":[],"run_command_targets":[],"sqs_target":[]},"after_sensitive":{"batch_target":[],"dead_letter_config":[],"ecs_target":[],"http_target":[],"input_transformer":[],"kinesis_target":[],"retry_policy":[],"run_command_targets":[],"sqs_target":[]}}},{"address":"aws_cloudwatch_log_group.log_group","mode":"managed","type":"aws_cloudwatch_log_group","name":"log_group","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["no-op"],"before":{"arn":"","id":"/aws/lambda/metrics-lambda-primary-lambda","kms_key_id":"","name":"/aws/lambda/metrics-lambda-primary-lambda","name_prefix":null,"retention_in_days":14,"tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"primary-example_lambda_log_group","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"primary-example_lambda_log_group","Owner":"Metricos","Product":"Metricos","Team":"Metricos"}},"after":{"arn":"","id":"/aws/lambda/metrics-lambda-primary-lambda","kms_key_id":"","name":"/aws/lambda/metrics-lambda-primary-lambda","name_prefix":null,"retention_in_days":14,"tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"primary-example_lambda_log_group","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"primary-example_lambda_log_group","Owner":"Metricos","Product":"Metricos","Team":"Metricos"}},"after_unknown":{},"before_sensitive":{"tags":{},"tags_all":{}},"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"aws_iam_role.lambda_execution_role","mode":"managed","type":"aws_iam_role","name":"lambda_execution_role","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["no-op"],"before":{"arn":"","assume_role_policy":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Sid\":\"\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}","create_date":"2021-06-20T04:15:15Z","description":"","force_detach_policies":false,"id":"terraform-20210620041514555500000001","inline_policy":[{"name":"terraform-20210620041517969300000003","policy":""}],"managed_policy_arns":[],"max_session_duration":3600,"name":"terraform-20210620041514555500000001","name_prefix":null,"path":"/","permissions_boundary":null,"tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"primary-execution_role","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"primary-execution_role","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"unique_id":"AROAYBXPULJKAPCCFKJ5K"},"after":{"arn":"","assume_role_policy":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Sid\":\"\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}","create_date":"2021-06-20T04:15:15Z","description":"","force_detach_policies":false,"id":"terraform-20210620041514555500000001","inline_policy":[{"name":"terraform-20210620041517969300000003","policy":""}],"managed_policy_arns":[],"max_session_duration":3600,"name":"terraform-20210620041514555500000001","name_prefix":null,"path":"/","permissions_boundary":null,"tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"primary-execution_role","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"primary-execution_role","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"unique_id":"AROAYBXPULJKAPCCFKJ5K"},"after_unknown":{},"before_sensitive":{"inline_policy":[{}],"managed_policy_arns":[false,false],"tags":{},"tags_all":{}},"after_sensitive":{"inline_policy":[{}],"managed_policy_arns":[false,false],"tags":{},"tags_all":{}}}},{"address":"aws_iam_role_policy.lambda_execution_policy","mode":"managed","type":"aws_iam_role_policy","name":"lambda_execution_policy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["no-op"],"before":{"id":"terraform-20210620041514555500000001:terraform-20210620041517969300000003","name":"terraform-20210620041517969300000003","name_prefix":null,"policy":"","role":"terraform-20210620041514555500000001"},"after":{"id":"terraform-20210620041514555500000001:terraform-20210620041517969300000003","name":"terraform-20210620041517969300000003","name_prefix":null,"policy":"","role":"terraform-20210620041514555500000001"},"after_unknown":{},"before_sensitive":{},"after_sensitive":{}}},{"address":"aws_iam_role_policy_attachment.lambda_execution_policy_attachment_vpc_access","mode":"managed","type":"aws_iam_role_policy_attachment","name":"lambda_execution_policy_attachment_vpc_access","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["no-op"],"before":{"id":"terraform-20210620041514555500000001-20210620041518840600000004","policy_arn":"","role":"terraform-20210620041514555500000001"},"after":{"id":"terraform-20210620041514555500000001-20210620041518840600000004","policy_arn":"","role":"terraform-20210620041514555500000001"},"after_unknown":{},"before_sensitive":{},"after_sensitive":{}}},{"address":"aws_iam_role_policy_attachment.lambda_logging_policy_attachment","mode":"managed","type":"aws_iam_role_policy_attachment","name":"lambda_logging_policy_attachment","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["no-op"],"before":{"id":"terraform-20210620041514555500000001-20210620041518845600000005","policy_arn":"","role":"terraform-20210620041514555500000001"},"after":{"id":"terraform-20210620041514555500000001-20210620041518845600000005","policy_arn":"","role":"terraform-20210620041514555500000001"},"after_unknown":{},"before_sensitive":{},"after_sensitive":{}}},{"address":"aws_lambda_function.lambda","mode":"managed","type":"aws_lambda_function","name":"lambda","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"code_signing_config_arn":null,"dead_letter_config":[],"description":null,"environment":[{"variables":{"AWS_MAX_ATTEMPTS":"11","AWS_RETRY_MODE":"adaptive","FUNCTION_NAME":"metrics-lambda-primary-lambda","LOG_LEVEL":"WARNING","RDS_INFO_SSM_PATH":"/rds/metricos/info","SLACK_CHANNEL":"metricos_alerts_dev"}}],"file_system_config":[],"filename":"/workspace/output/lambda.zip","function_name":"metrics-lambda-primary-lambda","handler":"main.lambda_handler","image_config":[],"image_uri":null,"kms_key_arn":null,"layers":null,"memory_size":128,"package_type":"Zip","publish":false,"reserved_concurrent_executions":-1,"role":"","runtime":"python3.8","s3_bucket":null,"s3_key":null,"s3_object_version":null,"source_code_hash":"W5+gUPgM78w789Fevf8xDUe/sfi26j3YmdGYVsbWfrU=","tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-lambda","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-lambda","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"timeout":60,"timeouts":null,"vpc_config":[{"subnet_ids":["subnet-081c9cbe188e2e3c5","subnet-08a678ede68202ff3","subnet-0bd9b444e36f39c73"]}]},"after_unknown":{"arn":true,"dead_letter_config":[],"environment":[{"variables":{}}],"file_system_config":[],"id":true,"image_config":[],"invoke_arn":true,"last_modified":true,"qualified_arn":true,"signing_job_arn":true,"signing_profile_version_arn":true,"source_code_size":true,"tags":{},"tags_all":{},"tracing_config":true,"version":true,"vpc_config":[{"security_group_ids":true,"subnet_ids":[false,false,false],"vpc_id":true}]},"before_sensitive":false,"after_sensitive":{"dead_letter_config":[],"environment":[{"variables":{"EVENT_BUS_ARN":true}}],"file_system_config":[],"image_config":[],"tags":{},"tags_all":{},"tracing_config":[],"vpc_config":[{"security_group_ids":[],"subnet_ids":[false,false,false]}]}}},{"address":"aws_lambda_permission.allow_alert_event_bridge_to_call_monitor_metric_lambdas_frequent[0]","mode":"managed","type":"aws_lambda_permission","name":"allow_alert_event_bridge_to_call_monitor_metric_lambdas_frequent","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["no-op"],"before":null,"after":null,"after_unknown":{},"before_sensitive":false,"after_sensitive":false}},{"address":"aws_lambda_permission.allow_metric_event_bridge_to_call_monitor_metric_lambda","mode":"managed","type":"aws_lambda_permission","name":"allow_metric_event_bridge_to_call_monitor_metric_lambda","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"action":"lambda:InvokeFunction","event_source_token":null,"function_name":"metrics-lambda-primary-lambda","principal":"events.amazonaws.com","qualifier":null,"source_account":null,"source_arn":"","statement_id_prefix":null},"after_unknown":{"id":true,"statement_id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_security_group.lambda_sg","mode":"managed","type":"aws_security_group","name":"lambda_sg","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"","name_prefix":"metrics-lambda-primary-lambda-sg","revoke_rules_on_delete":false,"tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-lambda-sg","Owner":"Metrics","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-lambda-sg","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"timeouts":null,"vpc_id":"vpc-003e06e33a87c22f5"},"after_unknown":{"arn":true,"egress":true,"id":true,"ingress":true,"name":true,"owner_id":true,"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"egress":[],"ingress":[],"tags":{},"tags_all":{}}}},{"address":"aws_security_group_rule.task_sg_egress_rule","mode":"managed","type":"aws_security_group_rule","name":"task_sg_egress_rule","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"cidr_blocks":[],"description":null,"from_port":0,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"-1","self":false,"to_port":0,"type":"egress"},"after_unknown":{"cidr_blocks":[false],"id":true,"security_group_id":true,"source_security_group_id":true},"before_sensitive":false,"after_sensitive":{"cidr_blocks":[false]}}},{"address":"aws_ssm_parameter.lambda_sg_id","mode":"managed","type":"aws_ssm_parameter","name":"lambda_sg_id","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"allowed_pattern":null,"description":"","name":"/metrics-lambda/lambda/sg_id/primary","overwrite":null,"tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-lambda_sg_id","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-lambda_sg_id","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tier":"Standard","type":"String"},"after_unknown":{"arn":true,"data_type":true,"id":true,"key_id":true,"tags":{},"tags_all":{},"value":true,"version":true},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{},"value":true}}}],"output_changes":{"lambda_function_arn":{"actions":["update"],"before":"","after_unknown":true,"before_sensitive":false,"after_sensitive":false},"lambda_function_name":{"actions":["no-op"],"before":"","after":"metrics-lambda-primary-lambda","after_unknown":false,"before_sensitive":false,"after_sensitive":false}},"prior_state":{"format_version":"0.1","terraform_version":"1.0.0","values":{"outputs":{"lambda_function_arn":{"sensitive":false,"value":""},"lambda_function_name":{"sensitive":false,"value":"metrics-lambda-primary-lambda"}},"root_module":{"resources":[{"address":"aws_cloudwatch_event_rule.Metricos_custom_alert_schedule_frequent[0]","mode":"managed","type":"aws_cloudwatch_event_rule","name":"Metricos_custom_alert_schedule_frequent","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"","description":"","event_bus_name":"default","event_pattern":null,"id":"metrics-lambda-pri20210709064633847000000001","is_enabled":true,"name":"metrics-lambda-pri20210709064633847000000001","name_prefix":"metrics-lambda-pri","role_arn":"","schedule_expression":"rate(2 minutes)","tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-alert-schedule","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-alert-schedule","Owner":"Metricos","Product":"Metricos","Team":"Metricos"}}},{"address":"aws_cloudwatch_event_rule.metrics_schedule","mode":"managed","type":"aws_cloudwatch_event_rule","name":"metrics_schedule","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"","description":"","event_bus_name":"default","event_pattern":null,"id":"metrics-lambda-pri20210708075056362700000001","is_enabled":true,"name":"metrics-lambda-pri20210708075056362700000001","name_prefix":"metrics-lambda-pri","role_arn":"","schedule_expression":"rate(2 minutes)","tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-metric-schedule","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"metrics-lambda-primary-metric-schedule","Owner":"Metricos","Product":"Metricos","Team":"Metricos"}}},{"address":"aws_cloudwatch_event_target.Metricos_custom_alert_event_target_frequent[0]","mode":"managed","type":"aws_cloudwatch_event_target","name":"Metricos_custom_alert_event_target_frequent","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"arn":"","batch_target":[],"dead_letter_config":[],"ecs_target":[],"event_bus_name":"default","http_target":[],"id":"metrics-lambda-pri20210709064633847000000001-terraform-20210709064657895500000003","input":"{\"actions\":[\"rds_connectivity_alert\"]}","input_path":"","input_transformer":[],"kinesis_target":[],"retry_policy":[],"role_arn":"","rule":"metrics-lambda-pri20210709064633847000000001","run_command_targets":[],"sqs_target":[],"target_id":"terraform-20210709064657895500000003"},"depends_on":["aws_iam_role_policy_attachment.lambda_execution_policy_attachment_vpc_access","aws_lambda_function.lambda","aws_security_group.lambda_sg","data.aws_ssm_parameter.custom_event_bus_arn","aws_cloudwatch_event_rule.Metricos_custom_alert_schedule_frequent","aws_iam_role.lambda_execution_role","data.archive_file.lambda_source_package","data.aws_iam_policy_document.lambda_assume_role_policy","data.aws_subnet_ids.private","data.aws_vpc.selected"]},{"address":"aws_cloudwatch_event_target.metric_event_target","mode":"managed","type":"aws_cloudwatch_event_target","name":"metric_event_target","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"arn":"","batch_target":[],"dead_letter_config":[],"ecs_target":[],"event_bus_name":"default","http_target":[],"id":"metrics-lambda-pri20210708075056362700000001-terraform-20210708075329318900000003","input":"{\"actions\":[\"publish_alb_max_rules\",\"publish_rds_max_connections\"]}","input_path":"","input_transformer":[],"kinesis_target":[],"retry_policy":[],"role_arn":"","rule":"metrics-lambda-pri20210708075056362700000001","run_command_targets":[],"sqs_target":[],"target_id":"terraform-20210708075329318900000003"},"depends_on":["aws_security_group.lambda_sg","data.aws_iam_policy_document.lambda_assume_role_policy","data.aws_subnet_ids.private","data.aws_vpc.selected","aws_cloudwatch_event_rule.metrics_schedule","aws_iam_role.lambda_execution_role","aws_iam_role_policy_attachment.lambda_execution_policy_attachment_vpc_access","aws_lambda_function.lambda","data.archive_file.lambda_source_package","data.aws_ssm_parameter.custom_event_bus_arn"]},{"address":"aws_cloudwatch_log_group.log_group","mode":"managed","type":"aws_cloudwatch_log_group","name":"log_group","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"","id":"/aws/lambda/metrics-lambda-primary-lambda","kms_key_id":"","name":"/aws/lambda/metrics-lambda-primary-lambda","name_prefix":null,"retention_in_days":14,"tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"primary-example_lambda_log_group","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"primary-example_lambda_log_group","Owner":"Metricos","Product":"Metricos","Team":"Metricos"}},"depends_on":["aws_iam_role.lambda_execution_role","aws_iam_role_policy_attachment.lambda_execution_policy_attachment_vpc_access","aws_lambda_function.lambda","aws_security_group.lambda_sg","data.aws_ssm_parameter.custom_event_bus_arn","data.aws_subnet_ids.private","data.aws_vpc.selected","data.archive_file.lambda_source_package","data.aws_iam_policy_document.lambda_assume_role_policy"]},{"address":"aws_iam_role.lambda_execution_role","mode":"managed","type":"aws_iam_role","name":"lambda_execution_role","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"","assume_role_policy":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Sid\":\"\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}","create_date":"2021-06-20T04:15:15Z","description":"","force_detach_policies":false,"id":"terraform-20210620041514555500000001","inline_policy":[{"name":"terraform-20210620041517969300000003","policy":""}],"managed_policy_arns":[],"max_session_duration":3600,"name":"terraform-20210620041514555500000001","name_prefix":null,"path":"/","permissions_boundary":null,"tags":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"primary-execution_role","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"tags_all":{"Application":"Metrics Lambda","Client":"Company","CreatedBy":"Company","Instance":"primary","Name":"primary-execution_role","Owner":"Metricos","Product":"Metricos","Team":"Metricos"},"unique_id":"AROAYBXPULJKAPCCFKJ5K"},"depends_on":["data.aws_iam_policy_document.lambda_assume_role_policy"]},{"address":"aws_iam_role_policy.lambda_execution_policy","mode":"managed","type":"aws_iam_role_policy","name":"lambda_execution_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"id":"terraform-20210620041514555500000001:terraform-20210620041517969300000003","name":"terraform-20210620041517969300000003","name_prefix":null,"policy":"","role":"terraform-20210620041514555500000001"},"depends_on":["data.aws_ssm_parameter.custom_event_bus_arn","aws_iam_role.lambda_execution_role","data.aws_caller_identity.current","data.aws_iam_policy_document.lambda_assume_role_policy","data.aws_iam_policy_document.lambda_execution_policy","data.aws_region.current"]},{"address":"aws_iam_role_policy_attachment.lambda_execution_policy_attachment_vpc_access","mode":"managed","type":"aws_iam_role_policy_attachment","name":"lambda_execution_policy_attachment_vpc_access","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"id":"terraform-20210620041514555500000001-20210620041518840600000004","policy_arn":"","role":"terraform-20210620041514555500000001"},"depends_on":["aws_iam_role.lambda_execution_role","data.aws_iam_policy_document.lambda_assume_role_policy"]},{"address":"aws_iam_role_policy_attachment.lambda_logging_policy_attachment","mode":"managed","type":"aws_iam_role_policy_attachment","name":"lambda_logging_policy_attachment","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"id":"terraform-20210620041514555500000001-20210620041518845600000005","policy_arn":"","role":"terraform-20210620041514555500000001"},"depends_on":["aws_iam_role.lambda_execution_role","data.aws_iam_policy_document.lambda_assume_role_policy"]},{"address":"data.archive_file.lambda_source_package","mode":"data","type":"archive_file","name":"lambda_source_package","provider_name":"registry.terraform.io/hashicorp/archive","schema_version":0,"values":{"excludes":[".gitignore"],"id":"dc5ac3eb360e61971ccd56a49cd46774e8d0f839","output_base64sha256":"W5+gUPgM78w789Fevf8xDUe/sfi26j3YmdGYVsbWfrU=","output_file_mode":null,"output_md5":"5c4b3f76c36f8592ddc1825780439b05","output_path":"/workspace/output/lambda.zip","output_sha":"dc5ac3eb360e61971ccd56a49cd46774e8d0f839","output_size":20300672,"source":[],"source_content":null,"source_content_filename":null,"source_dir":"./bin","source_file":null,"type":"zip"}},{"address":"data.aws_caller_identity.current","mode":"data","type":"aws_caller_identity","name":"current","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"account_id":"553479592532","arn":"","id":"553479592532","user_id":"AROAYBXPULJKB3KZQU5UM:bk-tim.gates"}},{"address":"data.aws_iam_policy_document.lambda_assume_role_policy","mode":"data","type":"aws_iam_policy_document","name":"lambda_assume_role_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"id":"3693445097","json":"","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["sts:AssumeRole"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[{"identifiers":["lambda.amazonaws.com"],"type":"Service"}],"resources":[],"sid":""}],"version":"2012-10-17"}},{"address":"data.aws_iam_policy_document.lambda_execution_policy","mode":"data","type":"aws_iam_policy_document","name":"lambda_execution_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"id":"908301718","json":"","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["ssm:GetParameter"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[],"resources":[],"sid":""},{"actions":["ssm:GetParametersByPath"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[],"resources":[],"sid":""},{"actions":["kms:Decrypt","kms:DescribeKey"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[],"resources":[],"sid":""},{"actions":["cloudwatch:PutMetricData","rds:DescribeDBClusterSnapshots","rds:DescribeDBInstances","tag:GetResources"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[],"resources":["*"],"sid":""},{"actions":["rds:DescribeDBSnapshots"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[],"resources":[],"sid":""},{"actions":["rds:DescribeDBClusters"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[],"resources":[],"sid":""},{"actions":["events:PutEvents"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[],"resources":[],"sid":""},{"actions":["elasticloadbalancing:DescribeAccountLimits","elasticloadbalancing:DescribeListeners","elasticloadbalancing:DescribeLoadBalancers","elasticloadbalancing:DescribeRules","elasticloadbalancing:DescribeTags"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[],"resources":["*"],"sid":""}],"version":"2012-10-17"}},{"address":"data.aws_region.current","mode":"data","type":"aws_region","name":"current","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":""}},{"address":"data.aws_ssm_parameter.custom_event_bus_arn","mode":"data","type":"aws_ssm_parameter","name":"custom_event_bus_arn","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"","id":"/custom-event-forwarder/primary/event-bus-arn","name":"/custom-event-forwarder/primary/event-bus-arn","type":"String","value":"","version":1,"with_decryption":true}},{"address":"data.aws_subnet_ids.private","mode":"data","type":"aws_subnet_ids","name":"private","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"filter":null,"id":"vpc-003e06e33a87c22f5","ids":["subnet-081c9cbe188e2e3c5","subnet-08a678ede68202ff3","subnet-0bd9b444e36f39c73"],"tags":{"Tier":"private"},"vpc_id":"vpc-003e06e33a87c22f5"}},{"address":"data.aws_vpc.selected","mode":"data","type":"aws_vpc","name":"selected","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"","cidr_block":"","cidr_block_associations":[{"association_id":"vpc-cidr-assoc-0049d97ee1e07df13","cidr_block":"","state":"associated"}],"default":false,"dhcp_options_id":"dopt-0eaf801167d504046","enable_dns_hostnames":true,"enable_dns_support":true,"filter":null,"id":"vpc-003e06e33a87c22f5","instance_tenancy":"default","ipv6_association_id":null,"ipv6_cidr_block":null,"main_route_table_id":"rtb-0a7cfd853a3348554","owner_id":"553479592532","state":"available","tags":{"Application":"Base Infrastructure","Client":"Company","Default":"true"}}}]}}},"configuration":{"provider_config":{"aws":{"name":"aws","version_constraint":">= 3.30.0"}},"root_module":{"outputs":{"lambda_function_arn":{"expression":{"references":["aws_lambda_function.lambda"]}},"lambda_function_name":{"expression":{"references":["aws_lambda_function.lambda"]}}},"resources":[{"address":"aws_cloudwatch_event_rule.Metricos_custom_alert_schedule","mode":"managed","type":"aws_cloudwatch_event_rule","name":"Metricos_custom_alert_schedule","provider_config_key":"aws","expressions":{"description":{"constant_value":""},"name_prefix":{"references":["local.full_name"]},"schedule_expression":{"constant_value":""},"tags":{"references":["local.common_tags","local.full_name"]}},"schema_version":0,"count_expression":{"references":["local.alert_schedule_count"]}},{"address":"aws_cloudwatch_event_rule.metrics_schedule","mode":"managed","type":"aws_cloudwatch_event_rule","name":"metrics_schedule","provider_config_key":"aws","expressions":{"description":{"constant_value":""},"name_prefix":{"references":["local.full_name"]},"schedule_expression":{"constant_value":""},"tags":{"references":["local.common_tags","local.full_name"]}},"schema_version":0},{"address":"aws_cloudwatch_event_target.Metricos_custom_alert_event_target","mode":"managed","type":"aws_cloudwatch_event_target","name":"Metricos_custom_alert_event_target","provider_config_key":"aws","expressions":{"arn":{"references":["aws_lambda_function.lambda"]},"input":{},"rule":{"references":["aws_cloudwatch_event_rule.Metricos_custom_alert_schedule[0]"]}},"schema_version":1,"count_expression":{"references":["local.alert_schedule_count"]}},{"address":"aws_cloudwatch_event_target.metric_event_target","mode":"managed","type":"aws_cloudwatch_event_target","name":"metric_event_target","provider_config_key":"aws","expressions":{"arn":{"references":["aws_lambda_function.lambda"]},"input":{},"rule":{"references":["aws_cloudwatch_event_rule.metrics_schedule"]}},"schema_version":1},{"address":"aws_cloudwatch_log_group.log_group","mode":"managed","type":"aws_cloudwatch_log_group","name":"log_group","provider_config_key":"aws","expressions":{"name":{"references":["aws_lambda_function.lambda"]},"retention_in_days":{"constant_value":14},"tags":{"references":["local.common_tags","local.name"]}},"schema_version":0},{"address":"aws_iam_role.lambda_execution_role","mode":"managed","type":"aws_iam_role","name":"lambda_execution_role","provider_config_key":"aws","expressions":{"assume_role_policy":{"references":["data.aws_iam_policy_document.lambda_assume_role_policy"]},"tags":{"references":["local.common_tags","local.name"]}},"schema_version":0},{"address":"aws_iam_role_policy.lambda_execution_policy","mode":"managed","type":"aws_iam_role_policy","name":"lambda_execution_policy","provider_config_key":"aws","expressions":{"policy":{"references":["data.aws_iam_policy_document.lambda_execution_policy"]},"role":{"references":["aws_iam_role.lambda_execution_role"]}},"schema_version":0},{"address":"aws_iam_role_policy_attachment.lambda_execution_policy_attachment_vpc_access","mode":"managed","type":"aws_iam_role_policy_attachment","name":"lambda_execution_policy_attachment_vpc_access","provider_config_key":"aws","expressions":{"policy_arn":{"constant_value":""},"role":{"references":["aws_iam_role.lambda_execution_role"]}},"schema_version":0},{"address":"aws_iam_role_policy_attachment.lambda_logging_policy_attachment","mode":"managed","type":"aws_iam_role_policy_attachment","name":"lambda_logging_policy_attachment","provider_config_key":"aws","expressions":{"policy_arn":{"constant_value":""},"role":{"references":["aws_iam_role.lambda_execution_role"]}},"schema_version":0},{"address":"aws_lambda_function.lambda","mode":"managed","type":"aws_lambda_function","name":"lambda","provider_config_key":"aws","expressions":{"environment":[{"variables":{"references":["var.log_level","local.function_name","local.metricos_rds_info_ssm_path_prefix","data.aws_ssm_parameter.custom_event_bus_arn","var.slack_channel"]}}],"filename":{"references":["data.archive_file.lambda_source_package"]},"function_name":{"references":["local.function_name"]},"handler":{"constant_value":""},"role":{"references":["aws_iam_role.lambda_execution_role"]},"runtime":{"constant_value":""},"source_code_hash":{"references":["data.archive_file.lambda_source_package"]},"tags":{"references":["local.common_tags","local.full_name"]},"timeout":{"constant_value":60},"vpc_config":[{"security_group_ids":{"references":["aws_security_group.lambda_sg"]},"subnet_ids":{"references":["data.aws_subnet_ids.private"]}}]},"schema_version":0,"depends_on":["aws_iam_role_policy_attachment.lambda_execution_policy_attachment_vpc_access"]},{"address":"aws_lambda_permission.allow_alert_event_bridge_to_call_monitor_metric_lambdas","mode":"managed","type":"aws_lambda_permission","name":"allow_alert_event_bridge_to_call_monitor_metric_lambdas","provider_config_key":"aws","expressions":{"action":{"constant_value":""},"function_name":{"references":["aws_lambda_function.lambda"]},"principal":{"constant_value":""},"source_arn":{"references":["aws_cloudwatch_event_rule.Metricos_custom_alert_schedule[0]"]}},"schema_version":0,"count_expression":{"references":["local.alert_schedule_count"]}},{"address":"aws_lambda_permission.allow_metric_event_bridge_to_call_monitor_metric_lambda","mode":"managed","type":"aws_lambda_permission","name":"allow_metric_event_bridge_to_call_monitor_metric_lambda","provider_config_key":"aws","expressions":{"action":{"constant_value":""},"function_name":{"references":["aws_lambda_function.lambda"]},"principal":{"constant_value":""},"source_arn":{"references":["aws_cloudwatch_event_rule.metrics_schedule"]}},"schema_version":0},{"address":"aws_security_group.lambda_sg","mode":"managed","type":"aws_security_group","name":"lambda_sg","provider_config_key":"aws","expressions":{"description":{"constant_value":""},"name_prefix":{"references":["local.full_name"]},"tags":{"references":["local.common_tags","local.full_name"]},"vpc_id":{"references":["data.aws_vpc.selected"]}},"schema_version":1},{"address":"aws_security_group_rule.task_sg_egress_rule","mode":"managed","type":"aws_security_group_rule","name":"task_sg_egress_rule","provider_config_key":"aws","expressions":{"cidr_blocks":{"constant_value":[]},"from_port":{"constant_value":0},"protocol":{"constant_value":""},"security_group_id":{"references":["aws_security_group.lambda_sg"]},"to_port":{"constant_value":0},"type":{"constant_value":""}},"schema_version":2},{"address":"aws_ssm_parameter.lambda_sg_id","mode":"managed","type":"aws_ssm_parameter","name":"lambda_sg_id","provider_config_key":"aws","expressions":{"description":{"constant_value":""},"name":{"references":["var.app_name","var.app_instance_name"]},"tags":{"references":["local.common_tags","local.full_name"]},"type":{"constant_value":""},"value":{"references":["aws_security_group.lambda_sg"]}},"schema_version":0},{"address":"data.archive_file.lambda_source_package","mode":"data","type":"archive_file","name":"lambda_source_package","provider_config_key":"archive","expressions":{"excludes":{"constant_value":[".gitignore"]},"output_path":{"references":["var.zipfile"]},"source_dir":{"references":["path.root"]},"type":{"constant_value":""}},"schema_version":0},{"address":"data.aws_caller_identity.current","mode":"data","type":"aws_caller_identity","name":"current","provider_config_key":"aws","schema_version":0},{"address":"data.aws_iam_policy_document.lambda_assume_role_policy","mode":"data","type":"aws_iam_policy_document","name":"lambda_assume_role_policy","provider_config_key":"aws","expressions":{"statement":[{"actions":{"constant_value":["sts:AssumeRole"]},"effect":{"constant_value":""},"principals":[{"identifiers":{"constant_value":["lambda.amazonaws.com"]},"type":{"constant_value":""}}]}]},"schema_version":0},{"address":"data.aws_iam_policy_document.lambda_execution_policy","mode":"data","type":"aws_iam_policy_document","name":"lambda_execution_policy","provider_config_key":"aws","expressions":{"statement":[{"actions":{"constant_value":["ssm:GetParameter"]},"effect":{"constant_value":""},"resources":{"references":["data.aws_region.current","data.aws_caller_identity.current"]}},{"actions":{"constant_value":["ssm:GetParametersByPath"]},"effect":{"constant_value":""},"resources":{"references":["data.aws_region.current","data.aws_caller_identity.current","local.metricos_rds_info_ssm_path_prefix"]}},{"actions":{"constant_value":["kms:DescribeKey","kms:Decrypt"]},"effect":{"constant_value":""},"resources":{"references":["var.aws_region","data.aws_caller_identity.current","var.aws_region","data.aws_caller_identity.current"]}},{"actions":{"constant_value":["cloudwatch:PutMetricData","rds:DescribeDBClusterSnapshots","rds:DescribeDBInstances","tag:GetResources"]},"effect":{"constant_value":""},"resources":{"constant_value":["*"]}},{"actions":{"constant_value":["rds:DescribeDBSnapshots"]},"effect":{"constant_value":""},"resources":{"references":["var.aws_region","data.aws_caller_identity.current"]}},{"actions":{"constant_value":["rds:DescribeDBClusters"]},"effect":{"constant_value":""},"resources":{"references":["var.aws_region","data.aws_caller_identity.current"]}},{"actions":{"constant_value":["events:PutEvents"]},"effect":{"constant_value":""},"resources":{"references":["data.aws_ssm_parameter.custom_event_bus_arn"]}},{"actions":{"constant_value":["elasticloadbalancing:DescribeAccountLimits","elasticloadbalancing:DescribeLoadBalancers","elasticloadbalancing:DescribeListeners","elasticloadbalancing:DescribeRules","elasticloadbalancing:DescribeTags"]},"effect":{"constant_value":""},"resources":{"constant_value":["*"]}}]},"schema_version":0},{"address":"data.aws_region.current","mode":"data","type":"aws_region","name":"current","provider_config_key":"aws","schema_version":0},{"address":"data.aws_ssm_parameter.custom_event_bus_arn","mode":"data","type":"aws_ssm_parameter","name":"custom_event_bus_arn","provider_config_key":"aws","expressions":{"name":{"constant_value":""}},"schema_version":0},{"address":"data.aws_subnet_ids.private","mode":"data","type":"aws_subnet_ids","name":"private","provider_config_key":"aws","expressions":{"tags":{"constant_value":{"Tier":"private"}},"vpc_id":{"references":["data.aws_vpc.selected"]}},"schema_version":0},{"address":"data.aws_vpc.selected","mode":"data","type":"aws_vpc","name":"selected","provider_config_key":"aws","expressions":{"state":{"constant_value":""},"tags":{"constant_value":{"Default":"true"}}},"schema_version":0}],"variables":{"app_instance_name":{"description":"Support for multi-tenant deployment"},"app_name":{"description":"Application name"},"aws_region":{"description":"The AWS region for the deployment"},"enable_alert":{"description":"Whether or not to enable alert"},"log_level":{"description":"Default log level for the lambda function"},"slack_channel":{"description":"Name of the slack channel to send the alert to"},"zipfile":{"description":"The path to the function's deployment package within the local filesystem"}}}}}
